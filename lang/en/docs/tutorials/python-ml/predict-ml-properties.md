# Machine Learning: Predict Using a Neural Network

This tutorial demonstrates how to perform predictions using
a [multilayer perceptron](https://en.wikipedia.org/wiki/Multilayer_perceptron)
trianed for regression
using [SciKit-Learn](https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html).

!!! warning "Caution"
In order to perform this tutorial, the [ML Training](train-ml-model.md) tutorial must be completed.

## 1. Acquire Data

The data we use in this tutorial is taken from a [recent model](http://doi.org/10.1126/sciadv.aax5101) of small molecule
adsorption to transition metal nanoparticles. Specifically, we use DFT-calculated values for the adsorption energy of
·CH<sub>3</sub>, CO, and ·OH radicals to Ag, Au, and Cu nanoparticles ranging in size from 55 to 172 atoms.

<a href="/extra/files/data_to_predict_with.csv" download="data_to_predict_with.csv">This File</a> contains the data we
will use in this tutorial for predictions. A sample of the first 5 lines in the file can be found below:

|CE_Local_eV|ChemPot_eV|MADS_eV
|----|---|----
|-2.38|-4.96|-2.10
|-3.35|-4.96|-2.10
|-4.81|-4.96|-2.10
|-4.60|-4.96|-2.10

## 2. Upload the Data

In order to upload predict data, we first click the `Dropbox` button in the [left sidebar](../../ui/left-sidebar.md).
This will bring us to the [Dropbox Page](../../jobs/ui/files-tab.md). We can then click the "Upload" button, circled
below:

![Dropbox Page with Upload](../../images/tutorials/dropbox_page_with_upload_circled.png "Dropbox page with upload circled")

Then, when the browser's upload window appears, we navigate to where we downloaded the file in section 1, and select it
for upload. If the upload was successful, the file will then be visible in the dropbox.

Take note of the name of the file. For the purposes of this tutorial, it should be named `data_to_predict_with.csv`

## 3. Create the ML Job

Next, we can create a new job by selecting the `Create Job` button in the [left sidebar](../../ui/left-sidebar.md). This
will bring us to a new job on the [Job Designer](../../jobs-designer/overview.md) page.

First, we will give the job a friendly name, such as "Python ML Tutorial Prediction" (see below). Then, we will click
the [Actions Button](../../jobs-designer/header-menu.md#Actions) (the three vertical dots in the upper-right of the job
designer), and choose "Select Workflow."

![Job Designer with Circles](../../images/tutorials/job_designer_python_ml_predict_name.png "Job designer page")

This will bring up the [Select Workflow](../../jobs-designer/actions-header-menu/select-workflow.md) dialogue. We then
search for "workflow:pyml_predict" and click on it to bring it into our account.

## 4. Configure the ML Workflow

We now have our ML workflow selected. Select the [Workflows Tab](../../jobs-designer/workflow-tab.md), and we can see
our predict workflow.

We can see two [subworkflows](../../workflows/components/subworkflows.md) available: `Set Up the Job`
and `Machine Learning`.

### Specify the Prediction Data

We will first configure the `Set Up the Job` workflow to accept our predict data.

Begin by selecting the "Declare Predict Data" workflow unit, circled below:

![Prediction Data IO Unit](../../images/tutorials/workflows_tab_declare_predict_circled.png "Predict Data IO Unit")

We can now see the "Declare Predict Data" IO unit. Because we named our file in dropbox `data_to_predict_with.csv`
earlier, we do not need to modify this unit. In a scenario where we wanted to use a different file name for our predict
data, the [Workflow Designer](../../workflow-designer/overview.md) could be used to modify the value.

!!!warning "A Word of Caution"
> The _only_ modifications that should be made in the `Set Up the Job` subworkflow are the filenames in the "Declare
> Training Data" and "Declare Predict Data" IO units. The `Set Up the Job` subworkflow is automatically re-configured
> during the training process. Modifying other values, or adding/removing workflow units to this subworkflow, can disrupt
> creation of the Predict workflow.

We will then close the Declare Predict Data IO unit by clicking on the "X" in the dialogue's upper right corner. This
will bring us back to the [Workflows Tab](../../jobs-designer/workflow-tab.md "Workflows Tab").

## 6. Submit the Job

Click the check-mark in the upper right of the job designer, in the [Header Menu](../../jobs-designer/header-menu.md) to
save the job. We now return to the [job explorer](../../jobs/ui/explorer.md) page with the job in a pre-submission
status.

We can now [run the job](../../jobs/actions/run.md) and wait for it to complete.

## 7. Analyze the Prediction Results

After a few minutes, the job will complete. In the [files tab](../../jobs/ui/files-tab.md), we can find a new file
called "predictions.csv", which contains the predictions generated by this model. Under the hood, this model is created
inside of the Train/Predict workflow unit.

## Animation

This tutorial is demonstrated in the following animation:

<div class="video-wrapper">
<iframe class="gifffer" width="100%" height="100%" src="https://www.youtube.com/embed/fRjFUSy50RY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

